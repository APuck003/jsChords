<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">; // Prevent error when combining scripts!


if (typeof console === 'undefined'){
  var console = {
    log:function(){},
    warn:function(){},
    assert:function(){},
    error:function(){},
    info:function(){}
  }
};

<span id='C'>/**
</span> * Chords Lib
 */
var C = {
    version: 'v0.1'
};

<span id='C-static-method-ajaxErr'>/**
</span> * Generic error handler for all AJAX errors. Logs the error message and 
 * status
 * 
 * @method
 * @param {Event} e
 * @static
 */
C.ajaxErr = function(e){
    if (e.statusText==&quot;OK&quot;) return;
    console.log(&quot;AJAX ERROR:&quot;+e.responseText+&quot; status=&quot;+e.statusText);
    console.log(e);
};

<span id='C-css_var-NOTES2'>/**
</span> * All base notes (no flats - major scale from C)
 * @member C
 * @var
 */
C.NOTES2  = [&quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;A&quot;, &quot;B&quot;];

<span id='C-css_var-NOTES'>/**
</span> * All notes (in semi-tones)
 * @member C
 * @var
 */
C.NOTES = [&quot;C&quot;, &quot;C#&quot;, &quot;D&quot;, &quot;D#&quot;, &quot;E&quot;, &quot;F&quot;, &quot;F#&quot;, &quot;G&quot;, &quot;G#&quot;, &quot;A&quot;, &quot;A#&quot;, &quot;B&quot;];

<span id='C-css_var-NOTESIoanna'>/**
</span> * Notes with different naming...
 * @member C
 * @var
 */
C.NOTESIoanna = [&quot;Do&quot;, &quot;Do+&quot;, &quot;Re&quot;, &quot;Re+&quot;, &quot;Mi&quot;, &quot;Fa&quot;, &quot;Fa+&quot;, &quot;Sol&quot;, &quot;Sol+&quot;, &quot;La&quot;, &quot;La+&quot;, &quot;Si&quot;];


// function lg(a){console.log(a)}
// Shortcut for console.log but may not work with IE!
lg = /*console.log =*/ Function.prototype.bind.call(console.log,console);


<span id='C-static-method-getFreq'>/**
</span> * Get a notes frequency
 * http://jonathan.bergknoff.com/journal/making-a-guitar-tuner-html5
 * 
 * F = Fo * 2^(n/12)
 * 
 * @param {Number} referenceFreq
 * @param {Number} halfToneOffset
 * @return {Number} frequency
 * @method
 * @static
 */
C.getFreq = function(referenceFreq, halfToneOffset){
    return (referenceFreq * Math.pow(2, (halfToneOffset/12)))
};

<span id='C-method-getFreqOffset'>/**
</span> * Calculate the distance between a note frequency and
 * a given one. The result is in half-tone steps and can
 * be less than 1
 * 
 * @param {Number} noteFreq Note frequency
 * @param {Number} currentFreq Testing frequency
 * @return {Number}
 */
C.getFreqOffset = function(noteFreq, currentFreq){
    return 12*Math.log2(currentFreq/noteFreq)
};

<span id='C-method-getAllFreq'>/**
</span> * Get all unique frequencies from C.Note.F along with
 * their note names. Returns array of objects each one
 * being {frequency: Nubmer, name: String}.
 * 
 * @return {Array}
 */
C.getAllFreq = function(){
    var fs = [];
    
    for (i in C.Note.F) {
	if (i[1]==&quot;b&quot;) continue;
	fs.push( {frequency: C.Note.F[i], name: i});
    };
    
    return fs;
};
</pre>
</body>
</html>
